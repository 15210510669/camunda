- name: Ensure common utilities are installed
  apt:
    name: "{{ item }}"
    state: present
  with_items:
    - curl
    - tar
    - unzip

- name: Ensure 'jq' is installed
  get_url:
    url: https://github.com/stedolan/jq/releases/download/jq-1.5/jq-linux64
    dest: /bin/jq
    mode: 0755

- name: Ensure 'jiq' is installed
  shell: |
    curl -L https://gobuilder.me/get/github.com/fiatjaf/jiq/cmd/jiq/jiq_master_linux-amd64.zip > jiq_master_linux64.zip && \
    unzip -o -j jiq_master_linux64.zip -d /bin/ && \
    rm -f jiq_master_linux64.zip

- name:
  lineinfile:
    name: /etc/profile.d/tz.sh
    line: 'export TZ={{ os_timezone }}'
    regexp: '^export TZ'
    create: yes
    state: present
    owner: root
    group: root
    mode: 0755

- name: Set {{ os_timezone }} timezone
  shell: timedatectl set-timezone {{ os_timezone }}

- name: Set locale to LANG={{ os_lang }}, LANGUAGE={{ os_language }}
  shell: localectl set-locale LANG={{ os_lang }} LANGUAGE={{ os_language}}