# Additional values file to run Zeebe on stable VMs
camunda-platform:
  zeebe:
    # Require n2-standard-2 to ensure the broker is the only application running on its node
    nodeSelector:
      cloud.google.com/gke-nodepool: n2-standard-2-stable

    # Ignore the stable VM node taints
    tolerations:
      - key: cloud.google.com/gke-spot
        operator: Equal
        effect: NoSchedule
        value: 'false'

  zeebe-gateway:
    # Prefer scheduling on any non-spot VM
    affinity:
      podAffinity:
        requiredDuringSchedulingIgnoredDuringExecution:
          - labelSelector:
              matchExpressions:
                - key: cloud.google.com/gke-spot
                  operator: In
                  values: [ 'false' ]
            topologyKey: "kubernetes.io/hostname"

    # Ignore the stable VM node taints
    tolerations:
      - key: cloud.google.com/gke-spot
        operator: Equal
        effect: NoSchedule
        value: 'false'
